
============= Initialized Observation Utils with Obs Spec =============

using obs modality: low_dim with keys: ['object', 'robot0_eef_quat', 'robot0_gripper_qpos', 'robot0_eef_pos']
using obs modality: rgb with keys: []
using obs modality: depth with keys: []
using obs modality: scan with keys: []

============= Loaded Environment Metadata =============
obs key object with shape (14,)
obs key robot0_eef_pos with shape (3,)
obs key robot0_eef_quat with shape (4,)
obs key robot0_gripper_qpos with shape (2,)
[robosuite WARNING] No private macro file found! (macros.py:53)
[robosuite WARNING] It is recommended to use a private macro file (macros.py:54)
[robosuite WARNING] To setup, run: python /opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/robosuite/scripts/setup_macros.py (macros.py:55)
Created environment with name NutAssemblySquare
Action size is 7
NutAssemblySquare
{
    "camera_depths": false,
    "camera_heights": 84,
    "camera_widths": 84,
    "control_freq": 20,
    "controller_configs": {
        "control_delta": true,
        "damping": 1,
        "damping_limits": [
            0,
            10
        ],
        "impedance_mode": "fixed",
        "input_max": 1,
        "input_min": -1,
        "interpolation": null,
        "kp": 150,
        "kp_limits": [
            0,
            300
        ],
        "orientation_limits": null,
        "output_max": [
            0.05,
            0.05,
            0.05,
            0.5,
            0.5,
            0.5
        ],
        "output_min": [
            -0.05,
            -0.05,
            -0.05,
            -0.5,
            -0.5,
            -0.5
        ],
        "position_limits": null,
        "ramp_ratio": 0.2,
        "type": "OSC_POSE",
        "uncouple_pos_ori": true
    },
    "has_offscreen_renderer": true,
    "has_renderer": false,
    "ignore_done": true,
    "render_gpu_device_id": 0,
    "reward_shaping": false,
    "robots": [
        "Panda"
    ],
    "use_camera_obs": false,
    "use_object_obs": true
}

OpenAI client initialized

============= Model Summary =============
BC (
  ModuleDict()
)

SequenceDataset: loading dataset into memory...
  0%|          | 0/200 [00:00<?, ?it/s]  8%|8         | 17/200 [00:00<00:01, 165.65it/s] 17%|#7        | 34/200 [00:00<00:01, 158.21it/s] 25%|##5       | 50/200 [00:00<00:00, 157.24it/s] 37%|###7      | 74/200 [00:00<00:00, 187.22it/s] 46%|####6     | 93/200 [00:00<00:00, 184.88it/s] 56%|#####6    | 112/200 [00:00<00:00, 165.76it/s] 64%|######4   | 129/200 [00:00<00:00, 146.33it/s] 72%|#######2  | 145/200 [00:00<00:00, 140.68it/s] 80%|########  | 160/200 [00:01<00:00, 103.04it/s] 88%|########7 | 175/200 [00:01<00:00, 112.52it/s] 94%|#########3| 188/200 [00:01<00:00, 116.28it/s]100%|##########| 200/200 [00:01<00:00, 136.15it/s]
SequenceDataset: caching get_item calls...
  0%|          | 0/30154 [00:00<?, ?it/s]  3%|3         | 927/30154 [00:00<00:03, 9261.77it/s]  6%|6         | 1854/30154 [00:00<00:03, 7185.62it/s] 10%|#         | 3027/30154 [00:00<00:03, 8975.06it/s] 14%|#3        | 4082/30154 [00:00<00:02, 9540.35it/s] 18%|#7        | 5407/30154 [00:00<00:02, 10799.25it/s] 23%|##2       | 6830/30154 [00:00<00:01, 11918.56it/s] 27%|##7       | 8232/30154 [00:00<00:01, 12586.40it/s] 32%|###1      | 9625/30154 [00:00<00:01, 13005.78it/s] 36%|###6      | 10939/30154 [00:00<00:01, 12254.44it/s] 42%|####2     | 12755/30154 [00:01<00:01, 13983.11it/s] 47%|####7     | 14175/30154 [00:01<00:01, 12984.12it/s] 51%|#####1    | 15501/30154 [00:01<00:01, 11673.32it/s] 56%|#####5    | 16830/30154 [00:01<00:01, 12099.18it/s] 60%|######    | 18230/30154 [00:01<00:00, 12617.43it/s] 66%|######5   | 19778/30154 [00:01<00:00, 13418.18it/s] 70%|#######   | 21146/30154 [00:01<00:00, 12044.63it/s] 74%|#######4  | 22392/30154 [00:02<00:00, 8182.79it/s]  79%|#######8  | 23705/30154 [00:02<00:00, 9194.63it/s] 84%|########3 | 25195/30154 [00:02<00:00, 10484.11it/s] 88%|########7 | 26410/30154 [00:02<00:00, 10826.62it/s] 92%|#########1| 27617/30154 [00:02<00:00, 10613.54it/s] 96%|#########5| 28915/30154 [00:02<00:00, 11226.53it/s]100%|#########9| 30108/30154 [00:02<00:00, 11085.47it/s]100%|##########| 30154/30154 [00:02<00:00, 11157.22it/s]

============= Training Dataset =============
SequenceDataset (
	path=tmp/square.hdf5
	obs_keys=('object', 'robot0_eef_pos', 'robot0_eef_quat', 'robot0_gripper_qpos')
	seq_length=1
	filter_key=none
	frame_stack=1
	pad_seq_length=True
	pad_frame_stack=True
	goal_mode=none
	cache_mode=all
	num_demos=200
	num_sequences=30154
)

**************************************************
Warnings generated by robomimic have been duplicated here (from above) for convenience. Please check them carefully.
**************************************************

  0%|          | 0/20 [00:00<?, ?it/s] 25%|##5       | 5/20 [00:00<00:00, 43.96it/s] 50%|#####     | 10/20 [00:00<00:00, 24.59it/s] 85%|########5 | 17/20 [00:00<00:00, 36.63it/s]100%|##########| 20/20 [00:00<00:00, 36.36it/s]
Train Epoch 1
{
    "Time_Data_Loading": 0.0001836260159810384,
    "Time_Epoch": 0.009189303716023762,
    "Time_Log_Info": 4.522005716959635e-06,
    "Time_Process_Batch": 4.910628000895182e-05,
    "Time_Train_Batch": 0.008913004398345947
}
video writes to /Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/../bc_trained_models/test/20240705131510/videos/NutAssemblySquare_epoch_1.mp4
rollout: env=NutAssemblySquare, horizon=10, use_goals=False, num_episodes=1
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [01:00<?, ?it/s]
run failed with error:
'list' object has no attribute 'tolist'

Traceback (most recent call last):
  File "train.py", line 378, in main
    train(config, device=device)
  File "train.py", line 263, in train
    all_rollout_logs, video_paths = TrainUtils.rollout_with_stats(
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/utils/train_utils.py", line 359, in rollout_with_stats
    rollout_info = run_rollout(
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/utils/train_utils.py", line 226, in run_rollout
    ac = policy(ob=ob_dict, goal=goal_dict)
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/algo/algo.py", line 525, in __call__
    ac = self.policy.get_action(obs_dict=ob, goal_dict=goal)
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/algo/bc.py", line 270, in get_action
    obs_dictionary = self._obs_to_obsdict(obs_dict["object"].tolist()[0])
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/algo/bc.py", line 146, in _obs_to_obsdict
    "object": obs_position.tolist(),
AttributeError: 'list' object has no attribute 'tolist'

