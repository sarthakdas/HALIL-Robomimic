
============= Initialized Observation Utils with Obs Spec =============

using obs modality: low_dim with keys: ['robot0_eef_quat', 'robot0_eef_pos', 'robot0_gripper_qpos', 'object']
using obs modality: rgb with keys: []
using obs modality: depth with keys: []
using obs modality: scan with keys: []

============= Loaded Environment Metadata =============
obs key object with shape (14,)
obs key robot0_eef_pos with shape (3,)
obs key robot0_eef_quat with shape (4,)
obs key robot0_gripper_qpos with shape (2,)
[robosuite WARNING] No private macro file found! (macros.py:53)
[robosuite WARNING] It is recommended to use a private macro file (macros.py:54)
[robosuite WARNING] To setup, run: python /opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/robosuite/scripts/setup_macros.py (macros.py:55)
Created environment with name NutAssemblySquare
Action size is 7
NutAssemblySquare
{
    "camera_depths": false,
    "camera_heights": 84,
    "camera_widths": 84,
    "control_freq": 20,
    "controller_configs": {
        "control_delta": true,
        "damping": 1,
        "damping_limits": [
            0,
            10
        ],
        "impedance_mode": "fixed",
        "input_max": 1,
        "input_min": -1,
        "interpolation": null,
        "kp": 150,
        "kp_limits": [
            0,
            300
        ],
        "orientation_limits": null,
        "output_max": [
            0.05,
            0.05,
            0.05,
            0.5,
            0.5,
            0.5
        ],
        "output_min": [
            -0.05,
            -0.05,
            -0.05,
            -0.5,
            -0.5,
            -0.5
        ],
        "position_limits": null,
        "ramp_ratio": 0.2,
        "type": "OSC_POSE",
        "uncouple_pos_ori": true
    },
    "has_offscreen_renderer": true,
    "has_renderer": false,
    "ignore_done": true,
    "render_gpu_device_id": 0,
    "reward_shaping": false,
    "robots": [
        "Panda"
    ],
    "use_camera_obs": false,
    "use_object_obs": true
}

OpenAI client initialized

============= Model Summary =============
KAT (
  ModuleDict()
)

SequenceDataset: loading dataset into memory...
  0%|          | 0/200 [00:00<?, ?it/s] 18%|#8        | 36/200 [00:00<00:00, 357.43it/s] 36%|###6      | 72/200 [00:00<00:00, 354.36it/s] 60%|######    | 120/200 [00:00<00:00, 410.02it/s] 82%|########1 | 163/200 [00:00<00:00, 416.34it/s]100%|##########| 200/200 [00:00<00:00, 411.94it/s]
SequenceDataset: caching get_item calls...
  0%|          | 0/30154 [00:00<?, ?it/s]  4%|4         | 1289/30154 [00:00<00:02, 12884.54it/s]  9%|8         | 2578/30154 [00:00<00:02, 11290.50it/s] 12%|#2        | 3720/30154 [00:00<00:02, 11135.30it/s] 16%|#6        | 4877/30154 [00:00<00:02, 11295.02it/s] 20%|#9        | 6012/30154 [00:00<00:02, 10923.81it/s] 24%|##3       | 7109/30154 [00:00<00:02, 10502.55it/s] 28%|##7       | 8396/30154 [00:00<00:01, 11229.00it/s] 32%|###1      | 9565/30154 [00:00<00:01, 11368.02it/s] 36%|###5      | 10810/30154 [00:00<00:01, 11694.50it/s] 40%|####      | 12097/30154 [00:01<00:01, 12044.90it/s] 44%|####4     | 13306/30154 [00:01<00:01, 10590.72it/s] 48%|####7     | 14399/30154 [00:01<00:01, 10288.56it/s] 51%|#####1    | 15451/30154 [00:01<00:01, 10337.39it/s] 55%|#####5    | 16641/30154 [00:01<00:01, 10776.47it/s] 59%|#####9    | 17869/30154 [00:01<00:01, 11205.13it/s] 63%|######3   | 19002/30154 [00:01<00:01, 10469.73it/s] 67%|######6   | 20066/30154 [00:01<00:01, 7439.60it/s]  70%|######9   | 20960/30154 [00:02<00:01, 7768.70it/s] 73%|#######2  | 22009/30154 [00:02<00:00, 8418.28it/s] 76%|#######6  | 22940/30154 [00:02<00:00, 8363.39it/s] 79%|#######9  | 23838/30154 [00:02<00:00, 6544.38it/s] 82%|########1 | 24591/30154 [00:02<00:00, 6066.32it/s] 84%|########3 | 25267/30154 [00:02<00:00, 5935.65it/s] 86%|########5 | 25907/30154 [00:02<00:00, 5904.11it/s] 89%|########8 | 26776/30154 [00:02<00:00, 6583.41it/s] 92%|#########1| 27734/30154 [00:03<00:00, 7357.94it/s] 96%|#########5| 28826/30154 [00:03<00:00, 8318.91it/s] 98%|#########8| 29696/30154 [00:03<00:00, 7892.13it/s]100%|##########| 30154/30154 [00:03<00:00, 8887.11it/s]

============= Training Dataset =============
SequenceDataset (
	path=tmp/square.hdf5
	obs_keys=('object', 'robot0_eef_pos', 'robot0_eef_quat', 'robot0_gripper_qpos')
	seq_length=1
	filter_key=none
	frame_stack=1
	pad_seq_length=True
	pad_frame_stack=True
	goal_mode=none
	cache_mode=all
	num_demos=200
	num_sequences=30154
)

**************************************************
Warnings generated by robomimic have been duplicated here (from above) for convenience. Please check them carefully.
**************************************************

  0%|          | 0/1 [00:00<?, ?it/s]100%|##########| 1/1 [00:00<00:00,  7.75it/s]100%|##########| 1/1 [00:00<00:00,  7.73it/s]
Train Epoch 1
{
    "Time_Data_Loading": 3.734827041625977e-05,
    "Time_Epoch": 0.002177906036376953,
    "Time_Log_Info": 2.106030782063802e-07,
    "Time_Process_Batch": 2.9365221659342447e-06,
    "Time_Train_Batch": 0.0021088004112243654
}
video writes to /Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/../kat_trained_models/test/20240705144410/videos/NutAssemblySquare_epoch_1.mp4
rollout: env=NutAssemblySquare, horizon=400, use_goals=False, num_episodes=1
  0%|          | 0/1 [00:00<?, ?it/s]API call successful.
100%|##########| 1/1 [02:46<00:00, 166.07s/it]100%|##########| 1/1 [02:46<00:00, 166.07s/it]

Epoch 1 Rollouts took 166.0708601474762s (avg) with results:
Env: NutAssemblySquare
{
    "Horizon": 400.0,
    "Return": 0.0,
    "Success_Rate": 0.0,
    "Time_Episode": 2.7678476691246034,
    "time": 166.0708601474762
}
save checkpoint to /Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/../kat_trained_models/test/20240705144410/models/model_epoch_1_NutAssemblySquare_success_0.0.pth

Epoch 1 Memory Usage: 830 MB

finished run successfully!
