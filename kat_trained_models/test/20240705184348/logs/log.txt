
============= Initialized Observation Utils with Obs Spec =============

using obs modality: low_dim with keys: ['robot0_eef_pos', 'object', 'robot0_eef_quat', 'robot0_gripper_qpos']
using obs modality: rgb with keys: []
using obs modality: depth with keys: []
using obs modality: scan with keys: []

============= Loaded Environment Metadata =============
obs key object with shape (14,)
obs key robot0_eef_pos with shape (3,)
obs key robot0_eef_quat with shape (4,)
obs key robot0_gripper_qpos with shape (2,)
[robosuite WARNING] No private macro file found! (macros.py:53)
[robosuite WARNING] It is recommended to use a private macro file (macros.py:54)
[robosuite WARNING] To setup, run: python /opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/robosuite/scripts/setup_macros.py (macros.py:55)
Created environment with name NutAssemblySquare
Action size is 7
NutAssemblySquare
{
    "camera_depths": false,
    "camera_heights": 84,
    "camera_widths": 84,
    "control_freq": 20,
    "controller_configs": {
        "control_delta": true,
        "damping": 1,
        "damping_limits": [
            0,
            10
        ],
        "impedance_mode": "fixed",
        "input_max": 1,
        "input_min": -1,
        "interpolation": null,
        "kp": 150,
        "kp_limits": [
            0,
            300
        ],
        "orientation_limits": null,
        "output_max": [
            0.05,
            0.05,
            0.05,
            0.5,
            0.5,
            0.5
        ],
        "output_min": [
            -0.05,
            -0.05,
            -0.05,
            -0.5,
            -0.5,
            -0.5
        ],
        "position_limits": null,
        "ramp_ratio": 0.2,
        "type": "OSC_POSE",
        "uncouple_pos_ori": true
    },
    "has_offscreen_renderer": true,
    "has_renderer": false,
    "ignore_done": true,
    "render_gpu_device_id": 0,
    "reward_shaping": false,
    "robots": [
        "Panda"
    ],
    "use_camera_obs": false,
    "use_object_obs": true
}

OpenAI client initialized

============= Model Summary =============
KAT (
  ModuleDict()
)

SequenceDataset: loading dataset into memory...
  0%|          | 0/200 [00:00<?, ?it/s] 10%|#         | 21/200 [00:00<00:00, 207.44it/s] 23%|##3       | 46/200 [00:00<00:00, 227.40it/s] 37%|###7      | 74/200 [00:00<00:00, 248.68it/s] 50%|####9     | 99/200 [00:00<00:00, 247.97it/s] 64%|######3   | 127/200 [00:00<00:00, 256.19it/s] 78%|#######8  | 156/200 [00:00<00:00, 263.21it/s] 92%|#########2| 184/200 [00:00<00:00, 266.68it/s]100%|##########| 200/200 [00:00<00:00, 256.06it/s]
SequenceDataset: caching get_item calls...
  0%|          | 0/30154 [00:00<?, ?it/s]  3%|3         | 920/30154 [00:00<00:03, 9198.06it/s]  7%|7         | 2153/30154 [00:00<00:02, 11033.99it/s] 11%|#1        | 3419/30154 [00:00<00:02, 11771.88it/s] 15%|#5        | 4597/30154 [00:00<00:02, 11619.87it/s] 19%|#9        | 5856/30154 [00:00<00:02, 11966.43it/s] 23%|##3       | 7054/30154 [00:00<00:02, 11524.84it/s] 27%|##7       | 8210/30154 [00:00<00:02, 10668.91it/s] 31%|###1      | 9459/30154 [00:00<00:01, 11205.36it/s] 35%|###5      | 10635/30154 [00:00<00:01, 11368.80it/s] 39%|###9      | 11816/30154 [00:01<00:01, 11498.48it/s] 43%|####3     | 12973/30154 [00:01<00:01, 10942.73it/s] 47%|####6     | 14077/30154 [00:01<00:01, 10848.42it/s] 50%|#####     | 15169/30154 [00:01<00:01, 10780.06it/s] 54%|#####3    | 16253/30154 [00:01<00:01, 10795.54it/s] 57%|#####7    | 17336/30154 [00:01<00:01, 10693.13it/s] 61%|######1   | 18497/30154 [00:01<00:01, 10961.56it/s] 65%|######4   | 19596/30154 [00:01<00:00, 10727.08it/s] 69%|######8   | 20671/30154 [00:02<00:01, 7702.74it/s]  72%|#######2  | 21762/30154 [00:02<00:00, 8440.56it/s] 76%|#######5  | 22858/30154 [00:02<00:00, 9063.15it/s] 79%|#######9  | 23852/30154 [00:02<00:00, 9126.23it/s] 82%|########2 | 24869/30154 [00:02<00:00, 9405.14it/s] 86%|########5 | 25856/30154 [00:02<00:00, 9011.07it/s] 89%|########8 | 26792/30154 [00:02<00:00, 8771.56it/s] 92%|#########1| 27694/30154 [00:02<00:00, 8786.21it/s] 95%|#########4| 28590/30154 [00:02<00:00, 8354.62it/s] 98%|#########7| 29476/30154 [00:02<00:00, 8492.50it/s]100%|##########| 30154/30154 [00:03<00:00, 9890.12it/s]

============= Training Dataset =============
SequenceDataset (
	path=tmp/square.hdf5
	obs_keys=('object', 'robot0_eef_pos', 'robot0_eef_quat', 'robot0_gripper_qpos')
	seq_length=1
	filter_key=none
	frame_stack=1
	pad_seq_length=True
	pad_frame_stack=True
	goal_mode=none
	cache_mode=all
	num_demos=200
	num_sequences=30154
)

**************************************************
Warnings generated by robomimic have been duplicated here (from above) for convenience. Please check them carefully.
**************************************************

  0%|          | 0/1 [00:00<?, ?it/s]100%|##########| 1/1 [00:00<00:00,  6.54it/s]100%|##########| 1/1 [00:00<00:00,  6.54it/s]
Train Epoch 1
{
    "Time_Data_Loading": 5.4566065470377606e-05,
    "Time_Epoch": 0.002568630377451579,
    "Time_Log_Info": 2.702077229817708e-07,
    "Time_Process_Batch": 3.401438395182292e-06,
    "Time_Train_Batch": 0.002488434314727783
}
video writes to /Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/../kat_trained_models/test/20240705184348/videos/NutAssemblySquare_epoch_1.mp4
rollout: env=NutAssemblySquare, horizon=200, use_goals=False, num_episodes=2
  0%|          | 0/2 [00:00<?, ?it/s]  0%|          | 0/2 [01:29<?, ?it/s]
Traceback (most recent call last):
  File "train.py", line 427, in <module>
    main(args)
  File "train.py", line 378, in main
    train(config, device=device)
  File "train.py", line 263, in train
    all_rollout_logs, video_paths = TrainUtils.rollout_with_stats(
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/utils/train_utils.py", line 359, in rollout_with_stats
    rollout_info = run_rollout(
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/utils/train_utils.py", line 226, in run_rollout
    ac = policy(ob=ob_dict, goal=goal_dict)
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/algo/algo.py", line 525, in __call__
    ac = self.policy.get_action(obs_dict=ob, goal_dict=goal)
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/algo/kat.py", line 281, in get_action
    self.kat_action_list = self.open_ai_client.process_ensemble(self.prompt_path, instruction, scene_objects, context_description)
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/llminterface/llm_utils.py", line 230, in process_ensemble
    response, text = self.lm(self.system_prompt, logit_bias=None, n=1, temperature=0)
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/llminterface/llm_utils.py", line 71, in lm
    response = self.client.chat.completions.create(
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/openai/_utils/_utils.py", line 277, in wrapper
    return func(*args, **kwargs)
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/openai/resources/chat/completions.py", line 643, in create
    return self._post(
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/openai/_base_client.py", line 1250, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/openai/_base_client.py", line 931, in request
    return self._request(
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/openai/_base_client.py", line 962, in _request
    response = self._client.send(
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpx/_client.py", line 1015, in _send_single_request
    response = transport.handle_request(request)
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpx/_transports/default.py", line 233, in handle_request
    resp = self._pool.handle_request(req)
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpcore/_sync/connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpcore/_sync/http11.py", line 143, in handle_request
    raise exc
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpcore/_sync/http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpcore/_sync/http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpcore/_sync/http11.py", line 224, in _receive_event
    data = self._network_stream.read(
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/httpcore/_backends/sync.py", line 126, in read
    return self._sock.recv(max_bytes)
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/ssl.py", line 1259, in recv
    return self.read(buflen)
  File "/opt/miniconda3/envs/robomimic_venv/lib/python3.8/ssl.py", line 1134, in read
    return self._sslobj.read(len)
KeyboardInterrupt
