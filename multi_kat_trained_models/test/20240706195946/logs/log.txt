
============= Initialized Observation Utils with Obs Spec =============

using obs modality: low_dim with keys: ['object', 'robot0_eef_quat', 'robot0_gripper_qpos', 'robot0_eef_pos']
using obs modality: rgb with keys: []
using obs modality: depth with keys: []
using obs modality: scan with keys: []

============= Loaded Environment Metadata =============
obs key object with shape (10,)
obs key robot0_eef_pos with shape (3,)
obs key robot0_eef_quat with shape (4,)
obs key robot0_gripper_qpos with shape (2,)
[robosuite WARNING] No private macro file found! (macros.py:53)
[robosuite WARNING] It is recommended to use a private macro file (macros.py:54)
[robosuite WARNING] To setup, run: python /opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/robosuite/scripts/setup_macros.py (macros.py:55)
Created environment with name Lift
Action size is 7
Lift
{
    "camera_depths": false,
    "camera_heights": 84,
    "camera_widths": 84,
    "control_freq": 20,
    "controller_configs": {
        "control_delta": true,
        "damping": 1,
        "damping_limits": [
            0,
            10
        ],
        "impedance_mode": "fixed",
        "input_max": 1,
        "input_min": -1,
        "interpolation": null,
        "kp": 150,
        "kp_limits": [
            0,
            300
        ],
        "orientation_limits": null,
        "output_max": [
            0.05,
            0.05,
            0.05,
            0.5,
            0.5,
            0.5
        ],
        "output_min": [
            -0.05,
            -0.05,
            -0.05,
            -0.5,
            -0.5,
            -0.5
        ],
        "position_limits": null,
        "ramp_ratio": 0.2,
        "type": "OSC_POSE",
        "uncouple_pos_ori": true
    },
    "has_offscreen_renderer": true,
    "has_renderer": false,
    "ignore_done": true,
    "render_gpu_device_id": 0,
    "reward_shaping": false,
    "robots": [
        "Panda"
    ],
    "use_camera_obs": false,
    "use_object_obs": true
}

OpenAI client initialized

============= Model Summary =============
Multi_KAT (
  ModuleDict()
)

SequenceDataset: loading dataset into memory...
  0%|          | 0/200 [00:00<?, ?it/s] 14%|#4        | 28/200 [00:00<00:00, 274.48it/s] 28%|##8       | 57/200 [00:00<00:00, 280.52it/s] 44%|####4     | 89/200 [00:00<00:00, 294.65it/s] 60%|#####9    | 119/200 [00:00<00:00, 294.00it/s] 74%|#######4  | 149/200 [00:00<00:00, 291.82it/s] 90%|######### | 180/200 [00:00<00:00, 295.36it/s]100%|##########| 200/200 [00:00<00:00, 293.70it/s]
SequenceDataset: caching get_item calls...
  0%|          | 0/9666 [00:00<?, ?it/s] 12%|#1        | 1136/9666 [00:00<00:00, 11355.54it/s] 25%|##4       | 2397/9666 [00:00<00:00, 12093.04it/s] 37%|###7      | 3607/9666 [00:00<00:00, 11929.18it/s] 50%|####9     | 4801/9666 [00:00<00:00, 11886.00it/s] 62%|######1   | 5990/9666 [00:00<00:00, 11749.28it/s] 74%|#######4  | 7166/9666 [00:00<00:00, 11518.54it/s] 86%|########6 | 8340/9666 [00:00<00:00, 11587.70it/s] 99%|#########9| 9571/9666 [00:00<00:00, 11812.39it/s]100%|##########| 9666/9666 [00:00<00:00, 11769.82it/s]

============= Training Dataset =============
SequenceDataset (
	path=tmp/lift.hdf5
	obs_keys=('object', 'robot0_eef_pos', 'robot0_eef_quat', 'robot0_gripper_qpos')
	seq_length=1
	filter_key=none
	frame_stack=1
	pad_seq_length=True
	pad_frame_stack=True
	goal_mode=none
	cache_mode=all
	num_demos=200
	num_sequences=9666
)

**************************************************
Warnings generated by robomimic have been duplicated here (from above) for convenience. Please check them carefully.
**************************************************

  0%|          | 0/1 [00:00<?, ?it/s]API call successful.
API call successful.

====== Raw log probabilities for each option ======
Option: B 	 log prob: -0.3322197
Option: The 	 log prob: -1.3322197
Option: Based 	 log prob: -4.5822196
Option: Option 	 log prob: -5.3322196
Option: E 	 log prob: -6.9572196
Softmax scores: [0.34724295 0.28429848 0.14841682 0.12774354 0.0922982 ]
Prediction set: []
Help needed!
API call successful.
API call successful.

====== Raw log probabilities for each option ======
Option: B 	 log prob: -0.6145979
Option: The 	 log prob: -0.8645979
Option: C 	 log prob: -4.364598
Option: Based 	 log prob: -4.614598
Option: Option 	 log prob: -5.364598
Softmax scores: [0.3067799  0.29181807 0.14491256 0.13784509 0.11864437]
Prediction set: []
Help needed!
API call successful.
API call successful.

====== Raw log probabilities for each option ======
Option: A 	 log prob: -0.30615032
Option: The 	 log prob: -1.8061503
Option: B 	 log prob: -3.0561504
Option: E 	 log prob: -3.8061504
Option: C 	 log prob: -4.0561504
Softmax scores: [0.30425471 0.22539743 0.17553969 0.15108842 0.14371975]
Prediction set: []
Help needed!
API call successful.
API call successful.

====== Raw log probabilities for each option ======
Option: B 	 log prob: -0.7200258
Option: The 	 log prob: -0.9700258
Option: A 	 log prob: -2.7200258
Option: E 	 log prob: -3.9700258
Option: Based 	 log prob: -4.220026
Softmax scores: [0.27471165 0.2613138  0.18414473 0.14341206 0.13641776]
Prediction set: []
Help needed!
API call successful.
API call successful.

====== Raw log probabilities for each option ======
Option: B 	 log prob: -0.3825075
Option: The 	 log prob: -1.6325076
Option: E 	 log prob: -3.3825076
Option: A 	 log prob: -3.3825076
Option: Based 	 log prob: -4.1325073
Softmax scores: [0.29861527 0.2325618  0.16388353 0.16388353 0.14105587]
Prediction set: []
Help needed!
100%|##########| 1/1 [06:22<00:00, 382.16s/it]100%|##########| 1/1 [06:22<00:00, 382.16s/it]
Train Epoch 1
{
    "Time_Data_Loading": 2.9301643371582033e-05,
    "Time_Epoch": 6.369336032867432,
    "Time_Log_Info": 4.80810801188151e-07,
    "Time_Process_Batch": 5.332628885904948e-06,
    "Time_Train_Batch": 6.369271536668141
}
video writes to /Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/../multi_kat_trained_models/test/20240706195946/videos/Lift_epoch_1.mp4
rollout: env=Lift, horizon=800, use_goals=False, num_episodes=1
  0%|          | 0/1 [00:00<?, ?it/s]API call successful.
100%|##########| 1/1 [01:26<00:00, 86.17s/it]100%|##########| 1/1 [01:26<00:00, 86.17s/it]

Epoch 1 Rollouts took 86.16807293891907s (avg) with results:
Env: Lift
{
    "Horizon": 42.0,
    "Return": 1.0,
    "Success_Rate": 1.0,
    "Time_Episode": 1.4361345489819846,
    "time": 86.16807293891907
}
save checkpoint to /Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/../multi_kat_trained_models/test/20240706195946/models/model_epoch_1_Lift_success_1.0.pth

Epoch 1 Memory Usage: 748 MB

finished run successfully!
