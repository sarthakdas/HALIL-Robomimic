
============= Initialized Observation Utils with Obs Spec =============

using obs modality: low_dim with keys: ['robot0_gripper_qpos', 'object', 'robot0_eef_quat', 'robot0_eef_pos']
using obs modality: rgb with keys: []
using obs modality: depth with keys: []
using obs modality: scan with keys: []

============= Loaded Environment Metadata =============
obs key object with shape (14,)
obs key robot0_eef_pos with shape (3,)
obs key robot0_eef_quat with shape (4,)
obs key robot0_gripper_qpos with shape (2,)
[robosuite WARNING] No private macro file found! (macros.py:53)
[robosuite WARNING] It is recommended to use a private macro file (macros.py:54)
[robosuite WARNING] To setup, run: python /opt/miniconda3/envs/robomimic_venv/lib/python3.8/site-packages/robosuite/scripts/setup_macros.py (macros.py:55)
Created environment with name PickPlaceCan
Action size is 7
PickPlaceCan
{
    "camera_depths": false,
    "camera_heights": 84,
    "camera_widths": 84,
    "control_freq": 20,
    "controller_configs": {
        "control_delta": true,
        "damping": 1,
        "damping_limits": [
            0,
            10
        ],
        "impedance_mode": "fixed",
        "input_max": 1,
        "input_min": -1,
        "interpolation": null,
        "kp": 150,
        "kp_limits": [
            0,
            300
        ],
        "orientation_limits": null,
        "output_max": [
            0.05,
            0.05,
            0.05,
            0.5,
            0.5,
            0.5
        ],
        "output_min": [
            -0.05,
            -0.05,
            -0.05,
            -0.5,
            -0.5,
            -0.5
        ],
        "position_limits": null,
        "ramp_ratio": 0.2,
        "type": "OSC_POSE",
        "uncouple_pos_ori": true
    },
    "has_offscreen_renderer": true,
    "has_renderer": false,
    "ignore_done": true,
    "render_gpu_device_id": 0,
    "reward_shaping": false,
    "robots": [
        "Panda"
    ],
    "use_camera_obs": false,
    "use_object_obs": true
}

OpenAI client initialized

============= Model Summary =============
Multi_KAT (
  ModuleDict()
)

SequenceDataset: loading dataset into memory...
  0%|          | 0/200 [00:00<?, ?it/s]  7%|7         | 14/200 [00:00<00:01, 138.57it/s] 16%|#5        | 31/200 [00:00<00:01, 155.85it/s] 24%|##4       | 49/200 [00:00<00:00, 165.70it/s] 33%|###3      | 66/200 [00:00<00:00, 167.17it/s] 42%|####1     | 83/200 [00:00<00:00, 165.99it/s] 50%|#####     | 100/200 [00:00<00:00, 165.07it/s] 58%|#####8    | 117/200 [00:00<00:00, 165.90it/s] 68%|######8   | 136/200 [00:00<00:00, 170.93it/s] 77%|#######7  | 154/200 [00:00<00:00, 172.79it/s] 86%|########6 | 173/200 [00:01<00:00, 174.87it/s] 96%|#########6| 192/200 [00:01<00:00, 176.65it/s]100%|##########| 200/200 [00:01<00:00, 168.96it/s]
SequenceDataset: caching get_item calls...
  0%|          | 0/23207 [00:00<?, ?it/s]  3%|3         | 789/23207 [00:00<00:02, 7885.81it/s]  7%|7         | 1713/23207 [00:00<00:02, 8680.23it/s] 12%|#1        | 2783/23207 [00:00<00:02, 9596.15it/s] 16%|#6        | 3743/23207 [00:00<00:02, 8767.43it/s] 21%|##        | 4816/23207 [00:00<00:01, 9433.84it/s] 25%|##5       | 5821/23207 [00:00<00:01, 9633.62it/s] 29%|##9       | 6806/23207 [00:00<00:01, 9699.80it/s] 34%|###4      | 7901/23207 [00:00<00:01, 10087.89it/s] 39%|###8      | 8952/23207 [00:00<00:01, 10215.50it/s] 43%|####3     | 10020/23207 [00:01<00:01, 10356.35it/s] 48%|####7     | 11058/23207 [00:01<00:01, 10279.58it/s] 52%|#####2    | 12088/23207 [00:01<00:01, 9833.75it/s]  56%|#####6    | 13077/23207 [00:01<00:01, 9387.21it/s] 61%|######    | 14127/23207 [00:01<00:00, 9702.64it/s] 66%|######5   | 15273/23207 [00:01<00:00, 10203.18it/s] 71%|#######   | 16391/23207 [00:01<00:00, 10486.16it/s] 75%|#######5  | 17446/23207 [00:01<00:00, 10461.20it/s] 80%|#######9  | 18496/23207 [00:01<00:00, 10022.81it/s] 84%|########4 | 19505/23207 [00:01<00:00, 9507.94it/s]  88%|########8 | 20464/23207 [00:02<00:00, 6268.69it/s] 92%|#########1| 21245/23207 [00:02<00:00, 6586.81it/s] 96%|#########5| 22240/23207 [00:02<00:00, 7356.70it/s] 99%|#########9| 23081/23207 [00:02<00:00, 7331.24it/s]100%|##########| 23207/23207 [00:02<00:00, 8857.74it/s]

============= Training Dataset =============
SequenceDataset (
	path=tmp/can.hdf5
	obs_keys=('object', 'robot0_eef_pos', 'robot0_eef_quat', 'robot0_gripper_qpos')
	seq_length=1
	filter_key=none
	frame_stack=1
	pad_seq_length=True
	pad_frame_stack=True
	goal_mode=none
	cache_mode=all
	num_demos=200
	num_sequences=23207
)

**************************************************
Warnings generated by robomimic have been duplicated here (from above) for convenience. Please check them carefully.
**************************************************

  0%|          | 0/1 [00:00<?, ?it/s]API call successful.
API call successful.

====== Raw log probabilities for each option ======
Option: C 	 log prob: 0.21877529644315136
Option: B 	 log prob: 0.21337371512794237
Option: D 	 log prob: 0.21337371512794237
Option: A 	 log prob: 0.18830165022544282
Option: E 	 log prob: 0.16617562307552117
Softmax scores: [0.2187753  0.21337372 0.21337372 0.18830165 0.16617562]
Prediction set: [2, 1, 3, 0, 4]
Help needed!
100%|##########| 1/1 [01:53<00:00, 113.61s/it]100%|##########| 1/1 [01:53<00:00, 113.61s/it]
Train Epoch 1
{
    "Time_Data_Loading": 5.377928415934245e-05,
    "Time_Epoch": 1.8935012817382812,
    "Time_Log_Info": 3.973642985026042e-07,
    "Time_Process_Batch": 5.586942036946615e-06,
    "Time_Train_Batch": 1.8934094349543253
}
video writes to /Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/../multi_kat_trained_models/test/20240725125435/videos/PickPlaceCan_epoch_1.mp4
rollout: env=PickPlaceCan, horizon=800, use_goals=False, num_episodes=1
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:06<?, ?it/s]
Traceback (most recent call last):
  File "train.py", line 427, in <module>
    main(args)
  File "train.py", line 378, in main
    train(config, device=device)
  File "train.py", line 263, in train
    all_rollout_logs, video_paths = TrainUtils.rollout_with_stats(
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/utils/train_utils.py", line 363, in rollout_with_stats
    rollout_info = run_rollout(
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/utils/train_utils.py", line 208, in run_rollout
    policy.start_episode()
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/algo/algo.py", line 487, in start_episode
    self.policy.reset()
  File "/Users/sarthakdas/Library/Mobile Documents/com~apple~CloudDocs/ComputerScience/Masters/RobotGym/robomimic/robomimic/algo/multi_kat.py", line 410, in reset
    time.sleep(60)
KeyboardInterrupt
